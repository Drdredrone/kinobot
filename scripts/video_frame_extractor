# /bin/bash

URL="$1"
TIMESTAMP="$2"
OUTPUT="$3"

echo "Video URL: $URL"

STREAM_URL=$(youtube-dl -g "$URL" -f 'bestvideo[height<=?1080]+bestaudio/best' | head -n 1)

ffmpeg -y -v quiet -stats -ss "$TIMESTAMP" -i "$STREAM_URL" -vf scale=iw*sar:ih -vframes 1 -q:v 2 "$OUTPUT"
